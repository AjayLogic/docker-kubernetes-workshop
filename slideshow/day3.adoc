:footer_copyright: Copyright Â©2015 Red Hat, Inc.
:imagesdir: images/
:speaker: Christian Posta
:speaker-title: Principal Middleware Architect
:speaker-email: christian@redhat.com
:speaker-blog: http://blog.christianposta.com
:speaker-twitter: http://twitter.com/christianposta[@christianposta]
:talk-speaker: {speaker}
:talk-name: Intro: Docker and Kubernetes training - Day 3
:talk-date: 10/21/2015

[#cover,data-background-image="revealjs-redhat/image/1156524-bg_redhat.png" data-background-color="#cc0000"]
== {blank-space}

[#block,width="200px",left="70px",top="0px"]
image::{revealjs_cover_image}[]

[#cover-h1,width="600px",left="0px",top="200px"]
{talk-name}

[#cover-h2,width="800px",left="0px",top="450px"]
{speaker} +
{talk-date}

// ************** who - christian ********
[#who]
== Who

[.noredheader,cols="30,70"]
|===
| image:ceposta.png[width="90%",height="100%"]
| {speaker-title}

Blog: {speaker-blog}

Twitter: {speaker-twitter}

Email: {speaker-email} |
|===

* Committer on Apache ActiveMQ, Apache Camel, Fabric8
* Technology evangelist, recovering consultant
* Spent a lot of time working with one of the largest Microservices, web-scale, unicorn companies
* Frequent blogger and speaker about open-source, cloud, microservices

// ************** Agenda  ********
[#agenda]
== Agenda

* Intro / Prep Environments
* Day 1: Docker Deep Dive
* Day 2: Kubernetes Deep Dive
* *Day 3: Advanced Kubernetes: Concepts, Management, Middleware*
* Day 4: Advanced Kubernetes: CI/CD, open discussions


// ************** transition page **************************************************************************************
[#transition1, data-background-image="revealjs-redhat/image/1156524-bg_redhat.png" data-background-color="#cc0000"]
== {blank-space}

[#block,width="200px",left="70px",top="0px"]
image::{revealjs_cover_image}[]

[#cover-h1,width="600px",left="0px",top="400px"]
*Quick Recap*

// ************** Recap ********
[#recap1]
== Recap Docker

* *Linux* containers
* Docker API
* Images
* Containers
* Registry

// ************** Recap ********
[#recap2]
== Why  Docker matters

* Application distribution
* Dependency management
* Application density
* Reduced management overhead in terms of VMs
* On premise, hybrid, public cloud

// ************** Recap ********
[#recap3]
== Recap Docker

* Containers run on *single* Docker host
* Containers are *ephemeral*
* Nothing watchdogs the containers
* Containers can have external persistence
* Containers do not contain
* Operating system *matters*


// ************** Kubernetes intro ***********
[#whatisit3]
== What is Kubernetes

* Smart placement
* How to interact with a system that does placement
* Different than configuration management
* *Containers will fail*
* Scaling


// ************** Recap ***********
[#whyisitimportant]
== Why is it important

* Managing containers by hand is harder that VMS: won't scale
* Automate the boilerplate stuff
* Runbooks -> Scripts -> Config management -> Scale
* Decouple application from machine!
* Applications run on "resources"
* Kubernetes manages this interaction of applications and resources
* *Manage applications, not machines!*
* What about *legacy apps?*

// ************** Recap ***********
[#coreconcets]
== Kubernetes core concepts

* Simplicity, Simplicity, Simplicity
* *Pods*
* *Labels* / *Selectors*
* *Replication Controllers*
* *Services*
* API


// ************** Recap ********
[#recap3]
== Why you win with Docker and Kubernetes

* Immutable infrastructure
* DevOps
* CI/CD
* *Who cares:* give me a platform to move faster!!!

// ************** transition page **************************************************************************************
[#deepdive, data-background-image="revealjs-redhat/image/1156524-bg_redhat.png" data-background-color="#cc0000"]
== {blank-space}

[#block,width="200px",left="70px",top="0px"]
image::{revealjs_cover_image}[]

[#cover-h1,left="0px",top="350px",width="2000px"]
*Kubernetes: Deeper Dive*

// ************** Deeper ********
[#namespaces]
== Kubernetes namespaces

* Divide cluster across uses, tiers, and teams
* Unique within a namespace; not across multiple namespaces
* Very powerful when combined with Labels
* Example: qa/dev/prod can be implemented with Namespaces


// ************** Deeper ********
[#namespaces1]
== Kubernetes namespaces

List the namespaces available to the cluster

```
kubectl get namespaces
```

List all the pods across all the namespaces

```
kubectl get pods --all-namespaces
```

Let's create a new namespace for our `guestbook` application:

```
curl -s -L https://raw.githubusercontent.com/christian-posta/docker-kubernetes-workshop/master/demos/guestbook/namespace.yaml | kubectl create -f -
```

// ************** Deeper ********
[#namespaces-contexts]
== Kubernetes Contexts / Namespaces

You can log into multiple kubernetes clusters with the same client and switch between clusters/contexts at the
command line. You can also specify which namespaces to use when pointing to specific clusters. For example, to
view the current cluster context:


```
kubectl config view
```
Sample output:

  - context:
      cluster: master-fuse-osecloud-com:8443
      namespace: microservice
      user: admin/master-fuse-osecloud-com:8443
    name: microservice/master-fuse-osecloud-com:8443/admin
  - context:
      cluster: vagrant
      user: vagrant
    name: vagrant
  current-context: vagrant
  kind: Config
  preferences: {}
  users:
  - name: admin/master-fuse-osecloud-com:8443
    user:
      token: kZ_L5Oj5sJ8nJUVJD4quq813Q1pRv4yZWhOjuJEw79w
  - name: vagrant
    user:
      client-certificate-data: REDACTED
      client-key-data: REDACTED
      password: vagrant
      username: vagrant


// ************** Deeper ********
[#namespaces-using-contexts]
== Setting and using context/namespaces

We can create a new context that points to our vagrant cluster:

```
kubectl config set-context guestbook --namespace=guestbook --user=vagrant --cluster=vagrant
```

Now, let's switch to use that context so we can put any new pods/RCs into this new namespace:

```
kubectl config  use-context guestbook
```

Now double check we're in the new context/namespace:

```
kubectl config view
```

// *********************************
[#questions]
== Questions

[.noredheader,cols="65,.<45"]
|===

.2+|image:questions.png[width="95%",height="95%"]
a|* Twitter : *{speaker-twitter}*
|===